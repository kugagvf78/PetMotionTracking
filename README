# ğŸ¾ Pet Monitoring System - Arduino + Flask Integration

## ğŸ“‹ Cáº¥u trÃºc há»‡ thá»‘ng

```
Arduino (Wokwi)  â†â†’  Serial USB  â†â†’  Python Bridge  â†â†’  Flask Server
     â†“                                      â†“
  PIR Sensor                          YOLO Detection
  RFID Button                         Camera Stream
  LED Indicators                      Web Dashboard
```

## ğŸ”Œ SÆ¡ Ä‘á»“ máº¡ch Wokwi

**ThÃ nh pháº§n:**
- Arduino Uno
- PIR Motion Sensor (Pin 2)
- 3x LED (Pin 3, 4, 5) + 220Î© resistors
  - LED Äá» (Pin 3): Motion detected
  - LED Xanh lÃ¡ (Pin 4): Pet verified by AI
  - LED Xanh dÆ°Æ¡ng (Pin 5): RFID detected
- Push Button (Pin 6): MÃ´ phá»ng RFID reader

## ğŸš€ CÃ¡ch cháº¡y

### 1. Setup Wokwi

1. VÃ o [Wokwi.com](https://wokwi.com)
2. Táº¡o project má»›i "Arduino Uno"
3. Copy ná»™i dung `diagram.json` vÃ o tab "diagram.json"
4. Copy ná»™i dung `sketch.ino` vÃ o tab "sketch.ino"
5. Click "Start Simulation"

### 2. Káº¿t ná»‘i Serial (2 cÃ¡ch)

#### CÃ¡ch 1: Wokwi Bridge (Recommend)
```bash
# Install Wokwi CLI
npm install -g wokwi-cli

# Connect to virtual serial port
wokwi-cli --port 9012
```

#### CÃ¡ch 2: Arduino tháº­t qua USB
1. Upload code `sketch.ino` lÃªn Arduino tháº­t
2. Cáº¯m USB vÃ o mÃ¡y tÃ­nh
3. Python sáº½ tá»± detect COM port

### 3. Cháº¡y Python

```bash
# Test Arduino connection trÆ°á»›c
python arduino_bridge.py

# Náº¿u OK, cháº¡y Flask server
python app_with_arduino.py
```

### 4. Má»Ÿ Web Dashboard

```
http://localhost:5000
```

## ğŸ“¡ Giao thá»©c Serial

### Arduino â†’ Python
```
PIR:1              # PIR detected motion
PIR:0              # No motion
RFID:VAN_CAT_001   # RFID tag scanned
PONG               # Response to PING
```

### Python â†’ Arduino
```
PET_DETECTED       # AI confirmed pet
NO_PET             # AI sees no pet
PING               # Health check
```

## ğŸ® Test trong Wokwi

1. **Test PIR**: Di chuyá»ƒn chuá»™t vÃ o PIR sensor â†’ LED Ä‘á» sÃ¡ng
2. **Test RFID**: Click nÃºt "RFID Sim" â†’ LED xanh dÆ°Æ¡ng nháº¥p nhÃ¡y 3 láº§n
3. **Test AI Response**: 
   - Khi PIR = 1 vÃ  webcam tháº¥y mÃ¨o/chÃ³
   - Arduino nháº­n `PET_DETECTED` â†’ LED xanh lÃ¡ sÃ¡ng 2s

## ğŸ” Debug

### Arduino khÃ´ng connect?
```bash
# List available ports
python -c "import serial.tools.list_ports; print([p.device for p in serial.tools.list_ports.comports()])"
```

### Wokwi serial khÃ´ng hoáº¡t Ä‘á»™ng?
- DÃ¹ng Arduino tháº­t thay Wokwi
- Hoáº·c dÃ¹ng Virtual COM port software

### LED khÃ´ng sÃ¡ng?
- Check diagram.json connections
- Verify pin numbers trong code
- Test vá»›i Serial Monitor trong Wokwi

## ğŸ“Š Features

### Thá»i gian thá»±c
- âœ… PIR motion detection
- âœ… RFID tag scanning
- âœ… AI pet verification (YOLO)
- âœ… Behavior scoring
- âœ… LED feedback trá»±c quan

### Logging
- âœ… Timestamp má»—i sá»± kiá»‡n
- âœ… Auto reset log má»—i ngÃ y
- âœ… Motion statistics
- âœ… Web API endpoints

## ğŸ› ï¸ NÃ¢ng cáº¥p

### ThÃªm cáº£m biáº¿n
```cpp
// Trong sketch.ino thÃªm:
#define ULTRASONIC_TRIGGER 7
#define ULTRASONIC_ECHO 8

// Äo khoáº£ng cÃ¡ch
long duration = pulseIn(ULTRASONIC_ECHO, HIGH);
int distance = duration * 0.034 / 2;
Serial.print("DISTANCE:");
Serial.println(distance);
```

### ThÃªm buzzer cáº£nh bÃ¡o
```cpp
#define BUZZER_PIN 9

// Khi khÃ´ng tháº¥y pet mÃ  PIR = 1
if (noPermissionAlert) {
  tone(BUZZER_PIN, 1000, 500); // Beep 500ms
}
```

## ğŸ“ Notes

- Baudrate: **115200** (pháº£i khá»›p cáº£ 2 bÃªn)
- Serial monitor trong Wokwi cÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ debug
- LEDs dÃ¹ng resistor 220Î© Ä‘á»ƒ trÃ¡nh chÃ¡y
- RFID button dÃ¹ng INPUT_PULLUP (active LOW)

## ğŸ¯ Workflow hoÃ n chá»‰nh

```
1. PIR phÃ¡t hiá»‡n chuyá»ƒn Ä‘á»™ng
   â†“
2. Arduino gá»­i PIR:1 qua Serial
   â†“
3. Python nháº­n vÃ  trigger camera + YOLO
   â†“
4. YOLO detect cat/dog
   â†“
5. Python gá»­i PET_DETECTED vá» Arduino
   â†“
6. Arduino báº­t LED xanh lÃ¡ xÃ¡c nháº­n
   â†“
7. Log Ä‘Æ°á»£c ghi vÃ o file + hiá»ƒn thá»‹ web
```

---

**LÃ m bá»Ÿi:** Pet Monitoring Team  
**Tech Stack:** Arduino + Python + Flask + YOLO + OpenCV  
**Status:** âœ… Production Ready